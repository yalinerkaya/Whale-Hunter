# whale-hunter
<div align="center">
  <img src="https://github.com/JayFreemandev/Whale-Hunter/assets/72185011/1c40f635-f819-40a0-98e6-737bf8cc97b7" width="50%"> <br>
  <img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fgithub.com%2FJayFreemandev%2FWhale-Hunter&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=hits&edge_flat=false" width="9%">
</div>
<hr>

### 프로젝트 소개
```
- 거래소에서 비트코인 정보를 조회하며 매수 시점 포착시 텔레그램에 알림을 보냅니다.
- 분산 서버 환경에서 일어날 수 있는 이슈를 시뮬레이션하고 서버의 성능 개선, 좋은 품질의 코드를 작성하기 위해 고민했습니다.
```
<hr>

### 주요 목표
- 서비스도중 장애를 겪었던 이유를 떠올려보며 문제 해결 능력을 다각화하여 시뮬레이션
- Microservices 아키텍처 기반의 시스템 개발
- 백엔드 환경에서 발생할 수 있는 성능 저하 요소 분석 및 코드 개선을 통한 성능 개선
<hr>


### 기술 

<table>
  <tr>
    <td>
        <img src="https://images.velog.io/images/xx0hn/post/b1987229-58c5-436a-8d28-512a7f4ab718/175E023350248C8837.jpeg" width="100px" />
    </td>
    <td>
        <img src="https://images.velog.io/images/leeseojune53/post/b6527e64-30c9-40d4-a955-ddbc647edec1/Gradle_logo.png" width="100px" />
    </td>
    <td>
        <img src="https://mblogthumb-phinf.pstatic.net/MjAxNzA4MDNfOTMg/MDAxNTAxNzYzODU4Mzc3.VFDhGiVlIJ_1-1n7eakK3HsfRDMbGyEAPVOdB6bYah4g.jFz8_8GL41JgQUiDryDYYoFl-FaqG48EKtcz-EdHANwg.PNG.scw0531/%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7_2017-08-03_%EC%98%A4%ED%9B%84_9.18.37.png?type=w2" width="100px" />
    </td>
    <td>  
        <img src="https://i0.wp.com/codegym.vn/wp-content/uploads/2020/06/spring-jpa-query-5.png?fit=400%2C400&ssl=1" width="100px" />
    </td>
    <td>
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTNVKGVT_dyDB_b758ACxJlJTKZFc6NaJvCI6Tt6V8RE5V6UnTP9ux_Pahj4DxhH7hiHeE&usqp=CAU" width="100px" />
    </td>
    <td>
        <img src="https://automated-testing.info/uploads/default/original/2X/7/760cbf21278280fd7d4980c577d64da634c9fc42.png" width="100px" />
    </td>
    <td>
        <img src="https://github.com/JayFreemandev/Whale-Hunter/assets/72185011/d50beb9c-61ff-4f38-ba1c-346a8cef3625" width="100px" />
    </td>
  </tr>
  <tr>
    <td><b>Java 11</b></td>
    <td><b>Gradle 8.0</b></td>
    <td><b>Spring Boot 2.7</b></td>
    <td><b>Srping Data JPA</b></td>
    <td><b>MySQL 8.x</b></td>
    <td><b>JUnit5 / Mockito</b></td>
    <td><b>Kafka 3.x</b></td>
  </tr>
</table>

### 스트레스 테스트
<table>
  <tr>
    <td>
        <img src="https://www.perfmatrix.com/wp-content/uploads/2020/07/JMeter-Logo.png" width="100px" />
    </td>
  </tr>
  <tr>
    <td><b>JMeter</b></td>
  </tr>
</table>

### 모니터링
<table>
  <tr>
    <td>
        <img src="https://github.com/JayFreemandev/Whale-Hunter/assets/72185011/5ee84dd8-7eb9-4905-b1c5-137cf75076c0" width="100px" />
    </td>
    <td>
        <img src="https://github.com/JayFreemandev/Whale-Hunter/assets/72185011/765dd265-940a-47ce-9067-57957479dfb6" width="100px" />
    </td>
    <td>
        <img src="https://github.com/JayFreemandev/Whale-Hunter/assets/72185011/6e256b78-d6f6-4cf0-9067-28f5103e7585" width="100px" />
    </td>
  </tr>
  <tr>
    <td><b>Zipkin</b></td>
    <td><b>Prometheus</b></td>
    <td><b>Grafana</b></td>
  </tr>
</table>

### 문서
<table>
  <tr>
    <td>
        <img src="https://user-images.githubusercontent.com/103566826/177922794-5a47df94-fc97-4beb-a6f4-16b24e315757.png" width="100px" />
    </td>
    <td>
        <img src="https://github.com/JayFreemandev/Whale-Hunter/assets/72185011/4d59ee1b-dd39-4725-b694-ddfcdaa3236d" width="100px" />
    </td>
  </tr>
  <tr>
    <td><b>GitHub Wiki</b></td>
    <td><b>Notion</b></td>
  </tr>
</table>
<hr>

### Architecture  
![image](https://github.com/JayFreemandev/Whale-Hunter/assets/72185011/edb3eb82-b0f1-4814-996f-ff72f4810d8c)
<hr>

### Sequence Diagram
![image](https://github.com/JayFreemandev/Whale-Hunter/assets/72185011/2ac84bea-e2bb-4566-affd-e12f131c7054)  
<hr>

### Message Example
![image](https://github.com/JayFreemandev/Whale-Hunter/assets/72185011/c10da3b7-9701-4ad1-900f-183ea4474a7b)
<hr>

### STRESS TEST 
*결과요약*

|  | 1차 50건 | 2차 50건 | --- 3차 3000건 | 
| --- | --- | --- | --- |
| TPS | 2/sec | 61/sec | 1000/sec |
<br>

## 컨벤션 (Branch, 커밋 메시지, API)
### Branch
- `develop` , `main` , `feature/*`
```
• develop : 개발용
• main : 배포용
• feature/* : 작업용
```

### 커밋 메시지([깃모지 사용](https://gitmoji.dev))
- 깃모지와 제목 사이에 띄어쓰기 하지 않음
```
[ 예시 ]
• 바이낸스 웹소켓 기능 추가
• (생략 가능) 부연 설명
• (생략 가능) 해결: #123 / 참고: #456, #789
```

> Subject
```
• 길어지지 않도록 작성
• "~ 추가", "~ 수정", "~ 리팩토링", ...
```

> Body
```
• 부연설명이 필요한 경우 선택하여 작성
```

> Footer
```
• 부가적으로 issue tracker id를 작성할 때 작성
```
<hr>

## [API Document 클릭시 이동](https://jayfreemandev.notion.site/API-f20ef3d1cee34c1bb42a6966a87a1d7e?pvs=4)
API 호출시 코드 0을 제외한 나머지는 에러로 정의

### Error Spec
**공용 에러 코드**  
| 에러 코드 | 에러 메시지                        | 해결 방법                 |
| ---- | ------------------------------- | ------------------------------- |
| 01001  | 서버 오류가 발생했습니다.   | 예상치 못한 서버 문제입니다. 로그 확인이 필요합니다. |
| 01002  | 잘못된 요청입니다.   | 바인딩 혹은 벨리데이션 확인이 필요합니다. |
| 01003  | 역직렬화에 실패했습니다.   | 해당 요청의 DESERIALIZE 확인이 필요합니다. |
| 01004  | 직렬화에 실패했습니다.   | 해당 요청의 SERIALIZE 확인이 필요합니다. |
<hr>

**트랙 서비스 에러 코드**  
| 에러 코드 | 에러 메시지                        | 해결 방법                 |
| ---- | ------------------------------- | ------------------------------- |
| 01014  | 웹소켓 연결에 실패했습니다.   | API KEY 확인 및 재연결이 필요합니다. |
| 01015  | 시그널 체크에 실패했습니다.   | 이벤트 바인딩 여부, 카프카 프로듀서 상태 체크가 필요합니다. |
| 01016  | 캔들스틱이 필요합니다.   | 캔들스틱 조회중 실패, DB 확인이 필요합니다. |
| 01017  | 이동평균값이 필요합니다.   | 이동평균값 조회중 실패, DB 확인이 필요합니다. |
<hr>

**메세지 서비스 에러 코드**  
| 에러 코드 | 에러 메시지                        | 해결 방법                 |
| ---- | ------------------------------- | ------------------------------- |
| 03000  | 텔레그램 전송에 실패했습니다.   | API KEY 확인 및 재전송 요청이 필요합니다. |
| 03001  | 코인이 필요합니다.   | 코인 조회중 실패, DB 확인이 필요합니다. |
| 03002  | 메세지 소비에 실패했습니다.   | 이벤트 바인딩 여부, 카프카 컨슈머 상태 체크가 필요합니다. |
<hr>

### [기술적 이슈(클릭시 이동)](https://github.com/JayFreemandev/Whale-Hunter/wiki)
- [전체 장애 방지를 위한 서킷 브레이커](https://github.com/JayFreemandev/Whale-Hunter/wiki/Resilience4j%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-%EC%A0%84%EC%B2%B4-%EC%9E%A5%EC%95%A0-%EB%B0%A9%EC%A7%80)
- [분산 환경에서 로그 관리를 어떻게 해야할까](https://github.com/JayFreemandev/Whale-Hunter/wiki/MSA-%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-%EB%A1%9C%EA%B9%85%EA%B3%BC-%EB%AA%A8%EB%8B%88%ED%84%B0%EB%A7%81-%EB%AC%B8%EC%A0%9C)
- [실시간 모니터링과 장애 감지를 어떻게 해야할까](https://github.com/JayFreemandev/Whale-Hunter/wiki/MSA-%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-%EB%A1%9C%EA%B9%85%EA%B3%BC-%EB%AA%A8%EB%8B%88%ED%84%B0%EB%A7%81-%EB%AC%B8%EC%A0%9C)
- [하드웨어 업그레이드 없이 TPS를 향상시켜보자](https://github.com/JayFreemandev/Whale-Hunter/wiki/Home/_edit)
- [분산 환경에서 트랜잭션 관리와 실패시 어떻게 재처리할까](https://github.com/JayFreemandev/Whale-Hunter/wiki/%EB%B6%84%EC%82%B0-%EC%8B%9C%EC%8A%A4%ED%85%9C-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98%EA%B3%BC-%EC%8B%A4%ED%8C%A8%EC%8B%9C-%EC%9E%AC%EC%B2%98%EB%A6%AC)
<hr>

### Feature Update List
**Real Time Chart**  
카프카 스트림즈를 통해 데이터베이스 없이 실시간 통신, Client 추가 기획될시 반영 예정
![clideo_editor_01ebdc15970a4dcda742d52ced34ecf4](https://github.com/JayFreemandev/Whale-Hunter/assets/72185011/90a2aa0b-7ebe-4796-8b6d-8665c43bbcb7)  
<hr>

**Gateway/Eureka**  
Client 추가 기획될시 반영 예정
<hr>

### 원하는 조건
- 200 EMA 1M above 
- 150 above 200 EMA above
- 50 above those two 
- price above 50 
- price is above at least 30% 52 weeks low
- price is within 25 percent 52 week high -> close and high is better -> percentage
- relative strength ranking less than 70 -> high better -> percentage
